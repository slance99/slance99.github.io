{
  "hash": "eed2f84cd9cd6d00882e0058f33138d0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Performing a PCA with Google Earth Engine Climate Data\"\ndescription: \"Analyzing the relationships between different climate variables (annual rainfall + temperature, wind, cloudiness, rain+ temperature seasonality, isothermality)\"\nauthor:\n  - name: Sam Lance\n    affiliation: Master of Environmental Science and Management at the The Bren School (UCSB), Advanced Data Analysis (ESM 244)\ndate: 9 March, 2025\ncategories: [Data Analysis, R] # self-defined categories\nimage: rain.jpg\nformat:\n  html:\n    code-fold: true\n    toc: false\n    number-sections: true\n    embed-resources: true\n    theme: Lux\neditor: visual\nexecute:\n  echo: true\n  message: false\n  warning: false\ndraft: false \n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(cowplot)\nlibrary(patchwork)\nlibrary(lubridate)\nlibrary(forcats)\nlibrary(stringr)\nlibrary(viridis)\nlibrary(tidymodels)\nlibrary(broom)\nlibrary(kableExtra)\nlibrary(ggfortify)\n```\n:::\n\n\n\n<img src=\"rain.jpg\" width=\"700px\"/>\n\n## Overview\n\n[**Data Description**]{.underline}:\n\nThis data is all acquired through Google Earth Engine (<https://earthengine.google.com/>) where publicly available remote sensing datasets have been uploaded. Most of the data is derived by calculating the mean for each country at a reduction scale of about 10km.\n\n[**Data Source**]{.underline}:\n\nVenter, Zander. (2018). Environmental variables for world countries. Retrieved 2025-02-02 from <https://www.kaggle.com/datasets/zanderventer/environmental-variables-for-world-countries>.\n\n[**Central Question**]{.underline}:\n\nWhat are the relationships between different climate variables (annual rainfall + temperature, wind, cloudiness, rain+ temperature seasonality, isothermality)?\n\n[**Psuedocode**]{.underline}:\n\n-   Wrangle + Clean Data\n\n    -   Explore data - create visualizations\n\n    -   Select variables to use in analysis\n\n-   Perform PCA on All Data\n\n    -   See what percentage of data is explained by the runs\n\n    -   See how each variable corresponds to each other\n\n-   Visualize PCA Results\n\n    -   Create biplot\n\n    -   Create screeplot\n\n## Loading Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclim_og <- read.csv(here(\"posts\",\"2025-03-19-pca-244\", \"data\", \"world_env_vars.csv\"))\n\nclim_mod <- clim_og|>\n  drop_na() |>\n  mutate(rain_seasonality = rain_seasonailty) |> #fix spelling error\n  select(\"rain_mean_annual\", \"temp_mean_annual\", \"wind\", \"cloudiness\", \"rain_seasonality\", \"temp_seasonality\", \"isothermality\") #select a few variables to look at for this analysis \n```\n:::\n\n\n\n## Perform the PCA\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#perform pca\nclim_pca <- clim_mod |>\n  select(where(is.numeric)) |> \n  prcomp(scale = TRUE)\n\n#generate summary table of results \n#summary(clim_pca)\n\n#perform rotation\nrot<- clim_pca$rotation\n\n#create summary to see how variables relate to the runs \n#sum <- summary(clim_pca)\n```\n:::\n\n\n\n## Create + Interpret Biplot\n\n### Creating Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nautoplot(clim_pca,\n     \tdata = clim_mod,\n     \tloadings = TRUE,\n     \tloadings.label = TRUE,\n     \tloadings.colour = \"black\",\n     \tloadings.label.colour = \"black\",\n     \tloadings.label.vjust = -0.5\n     \t) +\n  theme_minimal() \n```\n\n::: {.cell-output-display}\n![**Figure 1. Biplot of Principal Component Analysis**. This biplot shows the relationship between the different climate variables. The length of the line represents the variance in the PC direction, and the angle represents the correlation between the variables.](a2_task2_lance_sam_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n### Interpretation\n\n-   [Correlations:]{.underline}\n    -   Temperature seasonality and wind are highly correlated, meaning areas with highly seasonal climates have higher average wind speeds\n    -   Temperature seasonality is negatively correlated with isothermality, meaning areas with highly seasonal climates have less variation between day and night temperatures compared to the temperatures throughout the year\n    -   Cloudiness and rain seasonality are not correlated to isothermality, meaning increases in cloudiness or rain seasonality have no impact on isothermality\n\n## Create + Interpret Screeplot\n\n### Create Screeplot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npcs <- clim_pca$sdev^2  #square standard deviations \nvariances <- (pcs / sum(pcs)) *100  #proportion of variance explaine dby each variance \npc_numbers <- 1:length(variances)  #create vector of principal components\n\n#create a plot df with the numbers pc and the variances above \nscree_data <- data.frame(pc = pc_numbers, var = variances)\n\n#create screeplot \nggplot(scree_data, aes(x = pc, y = var)) +\n  geom_bar(stat = \"identity\", fill = \"darkgrey\", color = \"black\", width = 0.6) +\n  labs(x = \"Principal Component (#)\", y = \"Variance Explained (%)\") +\n  scale_x_continuous(breaks = seq(from = 1, to = 7, by = 1)) +\n  theme_minimal() +\n  theme(\n    axis.title = element_text(size = 12),\n  )\n```\n\n::: {.cell-output-display}\n![**Figure 2. Screeplot of Principal Component Analysis**. This screeplot shows the amount of variance captured by each component of the Principal Component Analysis. Over 75% of the data is captured in the first two components, with an additional 12% captured by the third component.](a2_task2_lance_sam_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n### Interpretation\n\n-   The majority of the variance within the data is explained with the first two components (75%)\n\n-   Adding the third principal component would explain an additional 12% of the data\n",
    "supporting": [
      "a2_task2_lance_sam_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}